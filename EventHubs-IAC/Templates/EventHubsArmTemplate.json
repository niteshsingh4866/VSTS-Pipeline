{ 
  "$schema": "https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
  "contentVersion": "1.0.0.0",
  "parameters": {
          "namespaceName":{
            "type": "string"
           },
          "eventHubName":{
            "type":"string"
          },
          "location":{
            "type":"string"
          },
          "retentionInDays":{
            "type": "int",
            "defaultValue": 1,
            "maxValue": 7,
            "minValue": 1

          },
          "partitionCount":{
            "type": "int",
            "defaultValue": 2,
            "maxValue": 32,
            "minValue": 1,
            "metadata": { "description": " The value of partition count resides between 2 and 32"  }
          },
          "CaptureEnable":{
            "type": "string",
            "allowedValues": ["true","false"]
          },
          "captureTimeInSeconds" :{
            "type": "int",
            "defaultValue":0,
            "metadata": { "description": " The value of partition count resides between 60 and 900"  }
          },
          "captureSize":{
            "type": "int",
            "defaultValue":0,
            "metadata": { "description": " The value of partition count resides between 10485760 and 524288000"  }
          },
          "StorageAccountName":{
            "type": "string"
          },
          "blobContainerName":{
            "type": "string"
          },
          "StorageAccountResourceGroup":{
            "type": "string"
          },
          "encoding":{
            "type": "string",
            "allowedValues": ["Avro","AvroDeflate"],
            "defaultValue": "Avro"
          }
    },
  "variables": { 
    "StorageResourceId": "[resourceId(parameters('StorageAccountResourceGroup'),'Microsoft.Storage/storageAccounts', parameters('StorageAccountName'))]"
},
"resources": [
  { 
      "type": "Microsoft.EventHub/namespaces/eventhubs",
      "name": "[concat(parameters('namespaceName'),'/',parameters('eventHubName'))]",
      "apiVersion": "2017-04-01",
      "location": "[parameters('location')]",
      "properties": {
        "messageRetentionInDays": "[parameters('retentionInDays')]",
        "partitionCount": "[parameters('partitionCount')]",
        "captureDescription": {
          "enabled":"[parameters('CaptureEnable')]",
          "encoding": "[parameters('encoding')]",
          "intervalInSeconds": "[parameters('captureTimeInSeconds')]",
          "sizeLimitInBytes": "[parameters('captureSize')]",
          "destination": {
            "name":"EventHubArchive.AzureBlockBlob",
            "properties": {
              "storageAccountResourceId":"[variables('StorageResourceId')]",
              "blobContainer":"[parameters('blobContainerName')]"
             } 
               }
         }
       }
  }
]

}

